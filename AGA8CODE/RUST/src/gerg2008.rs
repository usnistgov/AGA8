const RGERG: f64 = 8.314_472;
const NC_GERG: usize = 21;
const MAXFLDS: usize = 21;
const MAXMDL: usize = 10;
const MAXTRMM: usize = 12;
const MAXTRMP: usize = 24;
const EPSILON: f64 = 1.0e-15;

// Molar masses [g/mol]
const MMI_GERG: [f64; MAXFLDS + 1] = [
    0.0, 16.042_46,  // Methane
    28.013_4,   // Nitrogen
    44.009_5,   // Carbon dioxide
    30.069_04,  // Ethane
    44.095_62,  // Propane
    58.122_2,   // Isobutane
    58.122_2,   // n-Butane
    72.148_78,  // Isopentane
    72.148_78,  // n-Pentane
    86.175_36,  // Hexane
    100.201_94, // Heptane
    114.228_52, // Octane
    128.255_1,  // Nonane
    142.281_68, // Decane
    2.015_88,   // Hydrogen
    31.998_8,   // Oxygen
    28.010_1,   // Carbon monoxide
    18.015_28,  // Water
    34.080_88,  // Hydrogen sulfide
    4.002_602,  // Helium
    39.948,     // Argon
];

const KPOL: [usize; MAXFLDS + 1] = [
    0, 6, 6, 4, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 5, 6, 6, 7, 6, 4, 6,
];

const KEXP: [usize; MAXFLDS + 1] = [
    0, 18, 18, 18, 18, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 9, 6, 6, 9, 6, 8, 6,
];

const KPOLIJ: [usize; MAXMDL + 1] = [0, 2, 5, 2, 3, 2, 3, 4, 6, 6, 10];

const KEXPIJ: [usize; MAXMDL + 1] = [0, 10, 4, 7, 3, 4, 3, 0, 6, 6, 0];

// Critical densities [mol/l]
const DC: [f64; MAXFLDS + 1] = [
    0.0,
    10.139_342_719,
    11.183_9,
    10.624_978_698,
    6.870_854_54,
    5.000_043_088,
    3.860_142_94,
    3.920_016_792,
    3.271,
    3.215_577_588,
    2.705_877_875,
    2.315_324_434,
    2.056_404_127,
    1.81,
    1.64,
    14.94,
    13.63,
    10.85,
    17.873_716_09,
    10.19,
    17.399,
    13.407_429_659,
];

// Critical temperatures [K]
const TC: [f64; MAXFLDS + 1] = [
    0.0, 190.564, 126.192, 304.128_2, 305.322, 369.825, 407.817, 425.125, 460.35, 469.7, 507.82,
    540.13, 569.32, 594.55, 617.7, 33.19, 154.595, 132.86, 647.096, 373.1, 5.195_3, 150.687,
];

const NOIK: [[f64; MAXTRMP + 1]; MAXFLDS + 1] = [
    [
        0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
        0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
    ],
    [
        0.0,
        0.573_357_042_391_62,
        -1.676_068_752_373,
        0.234_052_918_349_16,
        -0.219_473_763_434_41,
        0.016_369_201_404_128,
        0.015_004_406_389_28,
        0.098_990_489_492_918,
        0.583_827_709_290_55,
        -0.747_868_675_603_9,
        0.300_333_028_579_74,
        0.209_855_438_065_68,
        -0.018_590_151_133_061,
        -0.157_825_583_390_49,
        0.127_167_352_207_91,
        -0.032_019_743_894_346,
        -0.068_049_729_364_536,
        0.024_291_412_853_736,
        0.005_144_045_163_944_4,
        -0.019_084_949_733_532,
        0.005_522_967_724_129_1,
        -0.004_419_739_297_608_5,
        0.040_061_416_708_429,
        -0.033_752_085_907_575,
        -0.002_512_765_821_335_7,
    ],
    [
        0.0,
        0.598_897_118_012_01,
        -1.694_155_748_073_1,
        0.245_797_361_917_18,
        -0.237_224_567_551_75,
        0.017_954_918_715_141,
        0.014_592_875_720_215,
        0.100_080_659_362_06,
        0.731_571_153_855_3,
        -0.883_722_723_363_66,
        0.318_876_602_467_08,
        0.207_664_917_287_99,
        -0.019_379_315_454_158,
        -0.169_366_415_549_83,
        0.135_468_460_417_01,
        -0.033_066_712_095_307,
        -0.060_690_817_018_557,
        0.012_797_548_292_871,
        0.005_874_366_410_729_9,
        -0.018_451_951_971_969,
        0.004_722_662_204_247_2,
        -0.005_202_407_968_059_9,
        0.043_563_505_956_635,
        -0.036_251_690_750_939,
        -0.002_897_402_686_654_3,
    ],
    [
        0.0,
        0.526_465_648_046_53,
        -1.499_572_504_259_2,
        0.273_297_867_337_82,
        0.129_495_000_227_86,
        0.154_040_883_418_41,
        -0.581_869_509_468_14,
        -0.180_224_948_382_96,
        -0.095_389_904_072_812,
        -0.008_048_681_931_767_9,
        -0.035_547_751_273_09,
        -0.280_790_148_824_05,
        -0.082_435_890_081_677,
        0.010_832_427_979_006,
        -0.006_707_399_316_109_7,
        -0.004_682_790_760_052_4,
        -0.028_359_911_832_177,
        0.019_500_174_744_098,
        -0.216_091_375_071_66,
        0.437_727_949_269_72,
        -0.221_307_901_135_93,
        0.015_190_189_957_331,
        -0.015_380_948_953_3,
        0.0,
        0.0,
    ],
    [
        0.0,
        0.635_967_804_507_14,
        -1.737_798_178_545_9,
        0.289_140_609_262_72,
        -0.337_142_768_456_94,
        0.022_405_964_699_561,
        0.015_715_424_886_913,
        0.114_506_342_537_45,
        1.061_204_937_974_5,
        -1.285_522_443_942_3,
        0.394_146_307_776_52,
        0.313_909_246_820_41,
        -0.021_592_277_117_247,
        -0.217_236_665_649_05,
        -0.289_995_744_394_89,
        0.423_211_730_257_3,
        0.046_434_100_259_26,
        -0.131_383_983_297_41,
        0.011_492_850_364_368,
        -0.033_387_688_429_909,
        0.015_183_171_583_644,
        -0.004_761_080_564_765_7,
        0.046_917_166_277_885,
        -0.039_401_755_804_649,
        -0.003_256_995_624_761_1,
    ],
    [
        0.0,
        1.040_397_310_735_8,
        -2.831_840_408_140_3,
        0.843_938_096_062_94,
        -0.076_559_591_850_023,
        0.094_697_373_057_28,
        0.000_247_964_754_970_06,
        0.277_437_604_228_7,
        -0.043_846_000_648_377,
        -0.269_910_647_843_5,
        -0.069_313_413_089_86,
        -0.029_632_145_981_653,
        0.014_040_126_751_38,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
    ],
    [
        0.0,
        1.042_933_158_91,
        -2.818_427_254_889_2,
        0.861_762_323_978_5,
        -0.106_136_194_524_87,
        0.098_615_749_302_134,
        0.000_239_482_086_823_22,
        0.303_300_048_569_5,
        -0.041_598_156_135_099,
        -0.299_919_374_700_58,
        -0.080_369_342_764_109,
        -0.029_761_373_251_151,
        0.013_059_630_303_14,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
    ],
    [
        0.0,
        1.062_627_741_145_5,
        -2.862_095_182_835,
        0.887_382_334_037_77,
        -0.125_705_811_553_45,
        0.102_863_087_081_06,
        0.000_253_580_406_026_54,
        0.323_252_002_339_82,
        -0.037_950_761_057_432,
        -0.325_348_020_144_52,
        -0.079_050_969_051_011,
        -0.020_636_720_547_775,
        0.005_705_380_933_475,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
    ],
    [
        0.0,
        1.096_3,
        -3.040_2,
        1.031_7,
        -0.154_1,
        0.115_35,
        0.000_298_09,
        0.395_71,
        -0.045_881,
        -0.358_04,
        -0.101_07,
        -0.035_484,
        0.018_156,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
    ],
    [
        0.0,
        1.096_864_309_800_1,
        -2.998_888_829_806_1,
        0.995_168_867_992_12,
        -0.161_707_085_585_39,
        0.113_344_600_727_75,
        0.000_267_605_951_507_48,
        0.409_798_819_869_31,
        -0.040_876_423_083_075,
        -0.381_694_824_694_47,
        -0.109_319_568_439_93,
        -0.032_073_223_327_99,
        0.016_877_016_216_975,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
    ],
    [
        0.0,
        1.055_323_801_366_1,
        -2.612_061_589_062_9,
        0.766_138_829_672_6,
        -0.297_703_206_224_59,
        0.118_799_077_333_58,
        0.000_279_228_610_626_17,
        0.463_475_898_441_05,
        0.011_433_196_980_297,
        -0.482_569_687_381_31,
        -0.093_750_558_924_659,
        -0.006_727_324_715_599_4,
        -0.005_114_158_358_542_8,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
    ],
    [
        0.0,
        1.054_374_764_526_2,
        -2.650_068_150_614_4,
        0.817_300_478_275_43,
        -0.304_513_912_534_28,
        0.122_538_687_108,
        0.000_272_664_727_439_28,
        0.498_658_256_816_7,
        -0.000_714_328_150_841_76,
        -0.542_368_955_254_5,
        -0.138_018_216_107_56,
        -0.006_159_528_738_001_1,
        0.000_486_025_103_930_22,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
    ],
    [
        0.0,
        1.072_254_487_563_3,
        -2.463_295_117_200_3,
        0.653_866_740_549_28,
        -0.363_249_740_856_28,
        0.127_132_696_267_6,
        0.000_307_135_727_779_3,
        0.526_568_569_875_4,
        0.019_362_862_857_653,
        -0.589_394_268_491_55,
        -0.140_699_639_919_34,
        -0.007_896_633_050_003_6,
        0.003_303_659_796_810_9,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
    ],
    [
        0.0,
        1.115_1,
        -2.702,
        0.834_16,
        -0.388_28,
        0.137_6,
        0.000_281_85,
        0.620_37,
        0.015_847,
        -0.617_26,
        -0.150_43,
        -0.012_982,
        0.004_432_5,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
    ],
    [
        0.0,
        1.046_1,
        -2.480_7,
        0.743_72,
        -0.525_79,
        0.153_15,
        0.000_328_65,
        0.841_78,
        0.055_424,
        -0.735_55,
        -0.185_07,
        -0.020_775,
        0.012_335,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
    ],
    [
        0.0,
        5.357_992_845_125_2,
        -6.205_025_253_059_5,
        0.138_302_413_270_86,
        -0.071_397_954_896_129,
        0.015_474_053_959_733,
        -0.149_768_064_057_71,
        -0.026_368_723_988_451,
        0.056_681_303_156_066,
        -0.060_063_958_030_436,
        -0.450_439_420_271_3,
        0.424_788_402_445,
        -0.021_997_640_827_139,
        -0.010_499_521_374_53,
        -0.002_895_590_286_681_6,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
    ],
    [
        0.0,
        0.888_782_863_697_01,
        -2.487_943_331_214_8,
        0.597_501_907_758_86,
        0.009_650_181_706_188_1,
        0.071_970_428_712_77,
        0.000_223_374_430_001_95,
        0.185_586_863_914_74,
        -0.038_129_368_035_76,
        -0.153_522_453_830_06,
        -0.026_726_814_910_919,
        -0.025_675_298_677_127,
        0.009_571_430_212_366_8,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
    ],
    [
        0.0,
        0.905_54,
        -2.451_5,
        0.531_49,
        0.024_173,
        0.072_156,
        0.000_188_18,
        0.194_05,
        -0.043_268,
        -0.127_78,
        -0.027_896,
        -0.034_154,
        0.016_329,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
    ],
    [
        0.0,
        0.827_284_087_495_86,
        -1.860_222_041_658_4,
        -1.119_900_961_374_4,
        0.156_357_539_760_56,
        0.873_758_448_590_25,
        -0.366_744_037_157_31,
        0.053_987_893_432_436,
        1.095_769_021_449_9,
        0.053_213_037_828_563,
        0.013_050_533_930_825,
        -0.410_795_204_344_76,
        0.146_374_433_441_2,
        -0.055_726_838_623_719,
        -0.011_201_774_143_8,
        -0.006_606_275_806_809_9,
        0.004_691_852_200_453_8,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
    ],
    [
        0.0,
        0.876_41,
        -2.036_7,
        0.216_34,
        -0.050_199,
        0.066_994,
        0.000_190_76,
        0.202_27,
        -0.004_534_8,
        -0.222_3,
        -0.034_714,
        -0.014_885,
        0.007_415_4,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
    ],
    [
        0.0,
        -0.455_790_240_067_37,
        1.251_639_075_492_5,
        -1.543_823_165_062_1,
        0.020_467_489_707_221,
        -0.344_762_123_807_81,
        -0.020_858_459_512_787,
        0.016_227_414_711_778,
        -0.057_471_818_200_892,
        0.019_462_416_430_715,
        -0.033_295_680_123_02,
        -0.010_863_577_372_367,
        -0.022_173_365_245_954,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
    ],
    [
        0.0,
        0.850_957_148_039_69,
        -2.400_322_294_348,
        0.541_278_414_764_66,
        0.016_919_770_692_538,
        0.068_825_965_019_035,
        0.000_214_280_328_153_38,
        0.174_298_953_219_92,
        -0.033_654_495_604_194,
        -0.135_267_998_576_91,
        -0.016_387_350_791_552,
        -0.024_987_666_851_475,
        0.008_876_920_481_570_9,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
    ],
];

const COIK: [[usize; MAXTRMP + 1]; MAXFLDS + 1] = [
    [
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
    ],
    [
        0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 3, 3, 3, 6, 6, 6, 6,
    ],
    [
        0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 3, 3, 3, 6, 6, 6, 6,
    ],
    [
        0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 2, 2, 3, 3, 3, 3, 3, 5, 5, 5, 6, 6, 0, 0,
    ],
    [
        0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 3, 3, 3, 6, 6, 6, 6,
    ],
    [
        0, 0, 0, 0, 0, 0, 0, 1, 1, 2, 2, 3, 3, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
    ],
    [
        0, 0, 0, 0, 0, 0, 0, 1, 1, 2, 2, 3, 3, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
    ],
    [
        0, 0, 0, 0, 0, 0, 0, 1, 1, 2, 2, 3, 3, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
    ],
    [
        0, 0, 0, 0, 0, 0, 0, 1, 1, 2, 2, 3, 3, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
    ],
    [
        0, 0, 0, 0, 0, 0, 0, 1, 1, 2, 2, 3, 3, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
    ],
    [
        0, 0, 0, 0, 0, 0, 0, 1, 1, 2, 2, 3, 3, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
    ],
    [
        0, 0, 0, 0, 0, 0, 0, 1, 1, 2, 2, 3, 3, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
    ],
    [
        0, 0, 0, 0, 0, 0, 0, 1, 1, 2, 2, 3, 3, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
    ],
    [
        0, 0, 0, 0, 0, 0, 0, 1, 1, 2, 2, 3, 3, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
    ],
    [
        0, 0, 0, 0, 0, 0, 0, 1, 1, 2, 2, 3, 3, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
    ],
    [
        0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 2, 2, 3, 3, 5, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
    ],
    [
        0, 0, 0, 0, 0, 0, 0, 1, 1, 2, 2, 3, 3, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
    ],
    [
        0, 0, 0, 0, 0, 0, 0, 1, 1, 2, 2, 3, 3, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
    ],
    [
        0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 2, 2, 2, 3, 5, 5, 0, 0, 0, 0, 0, 0, 0, 0,
    ],
    [
        0, 0, 0, 0, 0, 0, 0, 1, 1, 2, 2, 3, 3, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
    ],
    [
        0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 2, 3, 3, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
    ],
    [
        0, 0, 0, 0, 0, 0, 0, 1, 1, 2, 2, 3, 3, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
    ],
];

const DOIK: [[usize; MAXTRMP + 1]; MAXFLDS + 1] = [
    [
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
    ],
    [
        0, 1, 1, 2, 2, 4, 4, 1, 1, 1, 2, 3, 6, 2, 3, 3, 4, 4, 2, 3, 4, 5, 6, 6, 7,
    ],
    [
        0, 1, 1, 2, 2, 4, 4, 1, 1, 1, 2, 3, 6, 2, 3, 3, 4, 4, 2, 3, 4, 5, 6, 6, 7,
    ],
    [
        0, 1, 1, 2, 3, 3, 3, 4, 5, 6, 6, 1, 4, 1, 1, 3, 3, 4, 5, 5, 5, 5, 5, 0, 0,
    ],
    [
        0, 1, 1, 2, 2, 4, 4, 1, 1, 1, 2, 3, 6, 2, 3, 3, 4, 4, 2, 3, 4, 5, 6, 6, 7,
    ],
    [
        0, 1, 1, 1, 2, 3, 7, 2, 5, 1, 4, 3, 4, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
    ],
    [
        0, 1, 1, 1, 2, 3, 7, 2, 5, 1, 4, 3, 4, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
    ],
    [
        0, 1, 1, 1, 2, 3, 7, 2, 5, 1, 4, 3, 4, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
    ],
    [
        0, 1, 1, 1, 2, 3, 7, 2, 5, 1, 4, 3, 4, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
    ],
    [
        0, 1, 1, 1, 2, 3, 7, 2, 5, 1, 4, 3, 4, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
    ],
    [
        0, 1, 1, 1, 2, 3, 7, 2, 5, 1, 4, 3, 4, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
    ],
    [
        0, 1, 1, 1, 2, 3, 7, 2, 5, 1, 4, 3, 4, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
    ],
    [
        0, 1, 1, 1, 2, 3, 7, 2, 5, 1, 4, 3, 4, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
    ],
    [
        0, 1, 1, 1, 2, 3, 7, 2, 5, 1, 4, 3, 4, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
    ],
    [
        0, 1, 1, 1, 2, 3, 7, 2, 5, 1, 4, 3, 4, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
    ],
    [
        0, 1, 1, 2, 2, 4, 1, 5, 5, 5, 1, 1, 2, 5, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
    ],
    [
        0, 1, 1, 1, 2, 3, 7, 2, 5, 1, 4, 3, 4, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
    ],
    [
        0, 1, 1, 1, 2, 3, 7, 2, 5, 1, 4, 3, 4, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
    ],
    [
        0, 1, 1, 1, 2, 2, 3, 4, 1, 5, 5, 1, 2, 4, 4, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0,
    ],
    [
        0, 1, 1, 1, 2, 3, 7, 2, 5, 1, 4, 3, 4, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
    ],
    [
        0, 1, 1, 1, 4, 1, 3, 5, 5, 5, 2, 1, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
    ],
    [
        0, 1, 1, 1, 2, 3, 7, 2, 5, 1, 4, 3, 4, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
    ],
];

const TOIK: [[f64; MAXTRMP + 1]; MAXFLDS + 1] = [
    [
        0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
        0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
    ],
    [
        0.0, 0.125, 1.125, 0.375, 1.125, 0.625, 1.5, 0.625, 2.625, 2.75, 2.125, 2.0, 1.75, 4.5,
        4.75, 5.0, 4.0, 4.5, 7.5, 14.0, 11.5, 26.0, 28.0, 30.0, 16.0,
    ],
    [
        0.0, 0.125, 1.125, 0.375, 1.125, 0.625, 1.5, 0.625, 2.625, 2.75, 2.125, 2.0, 1.75, 4.5,
        4.75, 5.0, 4.0, 4.5, 7.5, 14.0, 11.5, 26.0, 28.0, 30.0, 16.0,
    ],
    [
        0.0, 0.0, 1.25, 1.625, 0.375, 0.375, 1.375, 1.125, 1.375, 0.125, 1.625, 3.75, 3.5, 7.5,
        8.0, 6.0, 16.0, 11.0, 24.0, 26.0, 28.0, 24.0, 26.0, 0.0, 0.0,
    ],
    [
        0.0, 0.125, 1.125, 0.375, 1.125, 0.625, 1.5, 0.625, 2.625, 2.75, 2.125, 2.0, 1.75, 4.5,
        4.75, 5.0, 4.0, 4.5, 7.5, 14.0, 11.5, 26.0, 28.0, 30.0, 16.0,
    ],
    [
        0.0, 0.25, 1.125, 1.5, 1.375, 0.25, 0.875, 0.625, 1.75, 3.625, 3.625, 14.5, 12.0, 0.0, 0.0,
        0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
    ],
    [
        0.0, 0.25, 1.125, 1.5, 1.375, 0.25, 0.875, 0.625, 1.75, 3.625, 3.625, 14.5, 12.0, 0.0, 0.0,
        0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
    ],
    [
        0.0, 0.25, 1.125, 1.5, 1.375, 0.25, 0.875, 0.625, 1.75, 3.625, 3.625, 14.5, 12.0, 0.0, 0.0,
        0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
    ],
    [
        0.0, 0.25, 1.125, 1.5, 1.375, 0.25, 0.875, 0.625, 1.75, 3.625, 3.625, 14.5, 12.0, 0.0, 0.0,
        0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
    ],
    [
        0.0, 0.25, 1.125, 1.5, 1.375, 0.25, 0.875, 0.625, 1.75, 3.625, 3.625, 14.5, 12.0, 0.0, 0.0,
        0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
    ],
    [
        0.0, 0.25, 1.125, 1.5, 1.375, 0.25, 0.875, 0.625, 1.75, 3.625, 3.625, 14.5, 12.0, 0.0, 0.0,
        0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
    ],
    [
        0.0, 0.25, 1.125, 1.5, 1.375, 0.25, 0.875, 0.625, 1.75, 3.625, 3.625, 14.5, 12.0, 0.0, 0.0,
        0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
    ],
    [
        0.0, 0.25, 1.125, 1.5, 1.375, 0.25, 0.875, 0.625, 1.75, 3.625, 3.625, 14.5, 12.0, 0.0, 0.0,
        0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
    ],
    [
        0.0, 0.25, 1.125, 1.5, 1.375, 0.25, 0.875, 0.625, 1.75, 3.625, 3.625, 14.5, 12.0, 0.0, 0.0,
        0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
    ],
    [
        0.0, 0.25, 1.125, 1.5, 1.375, 0.25, 0.875, 0.625, 1.75, 3.625, 3.625, 14.5, 12.0, 0.0, 0.0,
        0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
    ],
    [
        0.0, 0.5, 0.625, 0.375, 0.625, 1.125, 2.625, 0.0, 0.25, 1.375, 4.0, 4.25, 5.0, 8.0, 8.0,
        0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
    ],
    [
        0.0, 0.25, 1.125, 1.5, 1.375, 0.25, 0.875, 0.625, 1.75, 3.625, 3.625, 14.5, 12.0, 0.0, 0.0,
        0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
    ],
    [
        0.0, 0.25, 1.125, 1.5, 1.375, 0.25, 0.875, 0.625, 1.75, 3.625, 3.625, 14.5, 12.0, 0.0, 0.0,
        0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
    ],
    [
        0.0, 0.5, 1.25, 1.875, 0.125, 1.5, 1.0, 0.75, 1.5, 0.625, 2.625, 5.0, 4.0, 4.5, 3.0, 4.0,
        6.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
    ],
    [
        0.0, 0.25, 1.125, 1.5, 1.375, 0.25, 0.875, 0.625, 1.75, 3.625, 3.625, 14.5, 12.0, 0.0, 0.0,
        0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
    ],
    [
        0.0, 0.0, 0.125, 0.75, 1.0, 0.75, 2.625, 0.125, 1.25, 2.0, 1.0, 4.5, 5.0, 0.0, 0.0, 0.0,
        0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
    ],
    [
        0.0, 0.25, 1.125, 1.5, 1.375, 0.25, 0.875, 0.625, 1.75, 3.625, 3.625, 14.5, 12.0, 0.0, 0.0,
        0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
    ],
];

const DIJK: [[usize; MAXTRMM + 1]; MAXMDL + 1] = [
    [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
    [0, 3, 4, 1, 2, 2, 2, 2, 2, 2, 3, 3, 3],
    [0, 3, 3, 4, 4, 4, 1, 1, 1, 2, 0, 0, 0],
    [0, 1, 4, 1, 2, 2, 2, 2, 2, 3, 0, 0, 0],
    [0, 1, 2, 3, 1, 2, 3, 0, 0, 0, 0, 0, 0],
    [0, 2, 3, 1, 1, 1, 2, 0, 0, 0, 0, 0, 0],
    [0, 2, 2, 3, 1, 2, 2, 0, 0, 0, 0, 0, 0],
    [0, 1, 3, 3, 4, 0, 0, 0, 0, 0, 0, 0, 0],
    [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
    [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
    [0, 1, 1, 1, 2, 2, 3, 3, 4, 4, 4, 0, 0],
];

const TIJK: [[f64; MAXTRMM + 1]; MAXMDL + 1] = [
    [
        0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
    ],
    [
        0.0, 0.65, 1.55, 3.1, 5.9, 7.05, 3.35, 1.2, 5.8, 2.7, 0.45, 0.55, 1.95,
    ],
    [
        0.0, 1.85, 3.95, 0.0, 1.85, 3.85, 5.25, 3.85, 0.2, 6.5, 0.0, 0.0, 0.0,
    ],
    [
        0.0, 0.0, 1.85, 7.85, 5.4, 0.0, 0.75, 2.8, 4.45, 4.25, 0.0, 0.0, 0.0,
    ],
    [
        0.0, 2.6, 1.95, 0.0, 3.95, 7.95, 8.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
    ],
    [
        0.0, 1.85, 1.4, 3.2, 2.5, 8.0, 3.75, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
    ],
    [
        0.0, 0.0, 0.05, 0.0, 3.65, 4.9, 4.45, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
    ],
    [
        0.0, 2.0, -1.0, 1.75, 1.4, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
    ],
    [
        0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
    ],
    [
        0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
    ],
    [
        0.0, 1.0, 1.55, 1.7, 0.25, 1.35, 0.0, 1.25, 0.0, 0.7, 5.4, 0.0, 0.0,
    ],
];

const CIJK: [[f64; MAXTRMM + 1]; MAXMDL + 1] = [
    [
        0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
    ],
    [
        0.0, -0.0, -0.0, -1.0, -1.0, -1.0, -0.875, -0.75, -0.5, -0.0, -0.0, -0.0, -0.0,
    ],
    [
        0.0, -0.0, -0.0, -0.0, -0.0, -0.0, -0.25, -0.25, -0.0, -0.0, -0.0, -0.0, -0.0,
    ],
    [
        0.0, -0.0, -0.0, -1.0, -1.0, -0.25, -0.0, -0.0, -0.0, -0.0, -0.0, -0.0, -0.0,
    ],
    [
        0.0, -0.0, -0.0, -0.0, -1.0, -0.5, -0.0, -0.0, -0.0, -0.0, -0.0, -0.0, -0.0,
    ],
    [
        0.0, -0.0, -0.0, -0.25, -0.25, -0.0, -0.0, -0.0, -0.0, -0.0, -0.0, -0.0, -0.0,
    ],
    [
        0.0, -0.0, -0.0, -0.0, -1.0, -1.0, -0.875, -0.0, -0.0, -0.0, -0.0, -0.0, -0.0,
    ],
    [
        0.0, -0.0, -0.0, -0.0, -0.0, -0.0, -0.0, -0.0, -0.0, -0.0, -0.0, -0.0, -0.0,
    ],
    [
        0.0, -0.0, -0.0, -0.0, -0.0, -0.0, -0.0, -0.0, -0.0, -0.0, -0.0, -0.0, -0.0,
    ],
    [
        0.0, -0.0, -0.0, -0.0, -0.0, -0.0, -0.0, -0.0, -0.0, -0.0, -0.0, -0.0, -0.0,
    ],
    [
        0.0, -0.0, -0.0, -0.0, -0.0, -0.0, -0.0, -0.0, -0.0, -0.0, -0.0, -0.0, -0.0,
    ],
];

const EIJK: [[f64; MAXTRMM + 1]; MAXMDL + 1] = [
    [
        0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
    ],
    [
        0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.375, -0.75, -1.5, -3.0, -3.0, -3.0, -3.0,
    ],
    [
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        -0.5,
        -0.75,
        -2.0,
        -3.0,
        -6.923_472_305_982_402e-310,
        -6.952_861_644_092_627e-310,
        -6.923_472_305_939_714e-310,
    ],
    [
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        -2.25,
        -3.0,
        -3.0,
        -3.0,
        -3.0,
        -6.952_861_644_087_884e-310,
        -6.952_861_644_087_686e-310,
        -4.940_656_458_412_465e-324,
    ],
    [
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        -1.5,
        -3.0,
        -4.940_656_458_412_465e-324,
        -6.923_472_053_486_596e-310,
        -6.923_472_321_053_578e-310,
        -4.229_201_928_401_070e-321,
        -6.923_472_056_578_063e-310,
        -6.923_472_306_129_435e-310,
    ],
    [
        0.0,
        0.0,
        0.0,
        -0.5,
        -0.75,
        -2.0,
        -3.0,
        -3.586_279_664_080_114e-315,
        -4.669_164_244_212_619e-310,
        -5.603_561_627_735_270e-317,
        -6.952_861_644_104_089e-310,
        -6.952_861_644_103_299e-310,
        -6.952_861_644_094_208e-310,
    ],
    [
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        -0.375,
        -6.952_861_644_111_599e-310,
        -6.923_472_327_410_621e-310,
        0.0,
        -6.923_472_306_210_857e-310,
        -6.923_472_321_162_420e-310,
        -1.976_262_583_364_986e-323,
    ],
    [
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        -4.669_164_244_414_000e-310,
        -2.488_544_627_194_658e-314,
        -6.952_861_644_103_299e-310,
        -6.952_861_644_104_089e-310,
        -6.923_472_327_453_309e-310,
        0.0,
        -6.923_472_305_649_006e-310,
        -6.923_472_305_282_014e-310,
    ],
    [
        0.0,
        -6.923_472_322_066_017e-310,
        -6.923_472_054_798_241e-310,
        -6.923_472_306_129_435e-310,
        -6.923_472_305_253_556e-310,
        -6.923_472_235_302_556e-310,
        -6.952_861_644_150_729e-310,
        -6.923_472_323_403_255e-310,
        -6.923_472_305_446_489e-310,
        -2.964_393_875_047_479e-323,
        -6.923_472_305_454_344e-310,
        -4.669_164_249_378_569e-310,
        -6.952_861_644_159_424e-310,
    ],
    [
        0.0,
        -4.940_656_458_412_465e-324,
        -6.952_861_644_174_839e-310,
        -6.952_861_644_175_630e-310,
        -6.923_472_322_066_017e-310,
        -4.940_656_458_412_465e-324,
        0.0,
        -6.923_472_305_253_951e-310,
        -6.923_472_054_798_241e-310,
        -6.952_861_644_157_053e-310,
        -6.923_472_323_403_255e-310,
        -6.923_472_260_419_272e-310,
        -2.964_393_875_047_479e-323,
    ],
    [
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        -4.272_557_051_947_238e+180,
    ],
];

// const BIJK: [[f64; MAXTRMM+1]; MAXMDL+1] = [
//     [0.0, 6.923_472_321_800_704e-310, 4.940_656_458_412_465e-324, 6.923_472_306_129_435e-310, 6.952_861_644_061_402e-310, 6.923_472_321_800_704e-310, 4.940_656_458_412_465e-324, 6.923_472_321_002_590e-310, 6.952_861_644_062_983e-310, 1.090_896_946_017_472e-320, 6.923_472_306_129_435e-310, 4.940_656_458_412_465e-324, 6.923_472_053_753_787e-310, ],
//     [6.923_472_321_053_578e-310, 0.0, 0.0, 1.0, 1.0, 1.0, 1.25, 1.5, 2.0, 3.0, 3.0, 3.0, 3.0, ],
//     [3.701_125_297_565_758e-317, 0.0, 0.0, 0.0, 0.0, 0.0, 0.75, 1.0, 2.0, 3.0, 6.923_472_305_982_402e-310, 6.952_861_644_092_627e-310, 6.923_472_305_939_714e-310, ],
//     [6.923_472_321_002_590e-310, 0.0, 0.0, 1.0, 1.0, 2.5, 3.0, 3.0, 3.0, 3.0, 6.952_861_644_087_884e-310, 6.952_861_644_087_686e-310, 4.940_656_458_412_465e-324, ],
//     [6.923_435_667_182_394e-310, 0.0, 0.0, 0.0, 1.0, 2.0, 3.0, 4.940_656_458_412_465e-324, 6.923_472_053_486_596e-310, 6.923_472_321_053_578e-310, 4.229_201_928_401_070e-321, 6.923_472_056_578_063e-310, 6.923_472_306_129_435e-310, ],
//     [6.952_861_644_094_208e-310, 0.0, 0.0, 0.75, 1.0, 2.0, 3.0, 3.586_279_664_080_114e-315, 4.669_164_244_212_619e-310, 5.603_561_627_735_270e-317, 6.952_861_644_104_089e-310, 6.952_861_644_103_299e-310, 6.952_861_644_094_208e-310, ],
//     [6.923_472_306_205_719e-310, 0.0, 0.0, 0.0, 1.0, 1.0, 1.25, 6.952_861_644_111_599e-310, 6.923_472_327_410_621e-310, 0.0, 6.923_472_306_210_857e-310, 6.923_472_321_162_420e-310, 1.976_262_583_364_986e-323, ],
//     [6.923_472_306_210_857e-310, 0.0, 0.0, 0.0, 0.0, 4.669_164_244_414_000e-310, 2.488_544_627_194_658e-314, 6.952_861_644_103_299e-310, 6.952_861_644_104_089e-310, 6.923_472_327_453_309e-310, 0.0, 6.923_472_305_649_006e-310, 6.923_472_305_282_014e-310, ],
//     [2.121_995_790_471_207e-314, 6.923_472_322_066_017e-310, 6.923_472_054_798_241e-310, 6.923_472_306_129_435e-310, 6.923_472_305_253_556e-310, 6.923_472_235_302_556e-310, 6.952_861_644_150_729e-310, 6.923_472_323_403_255e-310, 6.923_472_305_446_489e-310, 2.964_393_875_047_479e-323, 6.923_472_305_454_344e-310, 4.669_164_249_378_569e-310, 6.952_861_644_159_424e-310, ],
//     [4.669_164_249_344_973e-310, 4.940_656_458_412_465e-324, 6.952_861_644_174_839e-310, 6.952_861_644_175_630e-310, 6.923_472_322_066_017e-310, 4.940_656_458_412_465e-324, 0.0, 6.923_472_305_253_951e-310, 6.923_472_054_798_241e-310, 6.952_861_644_157_053e-310, 6.923_472_323_403_255e-310, 6.923_472_260_419_272e-310, 2.964_393_875_047_479e-323, ],
//     [4.669_164_249_384_103e-310, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 4.272_557_051_947_238e+180, ],
// ];

const GIJK: [[f64; MAXTRMM + 1]; MAXMDL + 1] = [
    [
        0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
    ],
    [
        0.0, 0.0, 0.0, 0.25, 0.25, 0.25, 0.406_25, 0.562_5, 0.875, 1.5, 1.5, 1.5, 1.5,
    ],
    [
        0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.312_5, 0.437_5, 1.0, 1.5, 0.0, 0.0, 0.0,
    ],
    [
        0.0, 0.0, 0.0, 0.25, 0.25, 1.187_5, 1.5, 1.5, 1.5, 1.5, 0.0, 0.0, 0.0,
    ],
    [
        0.0, 0.0, 0.0, 0.0, 0.25, 0.875, 1.5, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
    ],
    [
        0.0, 0.0, 0.0, 0.312_5, 0.437_5, 1.0, 1.5, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
    ],
    [
        0.0, 0.0, 0.0, 0.0, 0.25, 0.25, 0.406_25, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
    ],
    [
        0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
    ],
    [
        0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
    ],
    [
        0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
    ],
    [
        0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
    ],
];

const NIJK: [[f64; MAXTRMM + 1]; MAXMDL + 1] = [
    [
        0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
    ],
    [
        0.0,
        -0.000_809_260_502_987_46,
        -0.000_753_819_250_800_59,
        -0.041_618_768_891_219,
        -0.234_521_736_815_69,
        0.140_038_405_845_86,
        0.063_281_744_807_738,
        -0.034_660_425_848_809,
        -0.239_187_473_342_51,
        0.001_985_525_506_689_1,
        6.177_774_617_155_5,
        -6.957_535_827_110_5,
        1.063_018_530_638_8,
    ],
    [
        0.0,
        0.013_746_429_958_576,
        -0.007_442_501_212_955_2,
        -0.004_551_660_021_368_5,
        -0.005_454_660_335_023_7,
        0.002_368_201_682_447_1,
        0.180_077_637_214_38,
        -0.447_739_429_324_86,
        0.019_327_374_888_2,
        -0.306_321_978_046_24,
        0.0,
        0.0,
        0.0,
    ],
    [
        0.0,
        -0.009_803_898_551_733_5,
        0.000_424_872_701_430_05,
        -0.034_800_214_576_142,
        -0.133_338_130_138_96,
        -0.011_993_694_974_627,
        0.069_243_379_775_168,
        -0.310_225_081_482_49,
        0.244_954_917_532_26,
        0.223_698_167_169_81,
        0.0,
        0.0,
        0.0,
    ],
    [
        0.0,
        -0.108_593_873_549_42,
        0.080_228_576_727_389,
        -0.009_330_398_511_571_7,
        0.040_989_274_005_848,
        -0.243_380_197_724_94,
        0.238_553_472_811_24,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
    ],
    [
        0.0,
        0.286_616_250_283_99,
        -0.109_198_338_612_47,
        -1.137_403_208_227,
        0.765_805_442_373_58,
        0.004_263_800_092_681_9,
        0.176_735_382_045_34,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
    ],
    [
        0.0,
        -0.473_765_181_266_08,
        0.489_611_934_610_01,
        -0.005_701_106_209_053_5,
        -0.199_668_200_413_2,
        -0.694_111_031_017_23,
        0.692_261_927_390_21,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
    ],
    [
        0.0,
        -0.251_571_349_719_34,
        -0.006_220_384_111_198_3,
        0.088_850_315_184_396,
        -0.035_592_212_573_239,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
    ],
    [
        0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
    ],
    [
        0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
    ],
    [
        0.0,
        2.557_477_684_411_8,
        -7.984_635_713_635_3,
        4.785_913_146_580_6,
        -0.732_653_923_695_87,
        1.380_547_134_531_2,
        0.283_496_034_763_65,
        -0.490_873_859_404_25,
        -0.102_918_889_214_47,
        0.118_363_146_819_68,
        5.552_738_572_194_3e-05,
        0.0,
        0.0,
    ],
];

const FIJ: [[f64; MAXFLDS + 1]; MAXFLDS + 1] = [
    [
        0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
        0.0, 0.0, 0.0, 0.0,
    ],
    [
        0.0,
        0.0,
        1.0,
        1.0,
        1.0,
        1.0,
        0.771_035_405_688,
        1.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        1.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
    ],
    [
        0.0, 1.0, 0.0, 1.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
        0.0, 0.0, 0.0, 0.0,
    ],
    [
        0.0, 1.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
        0.0, 0.0, 0.0, 0.0,
    ],
    [
        0.0,
        1.0,
        1.0,
        0.0,
        0.0,
        0.130_424_765_15,
        0.260_632_376_098,
        0.281_570_073_085,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
    ],
    [
        0.0,
        1.0,
        0.0,
        0.0,
        0.130_424_765_15,
        0.0,
        -0.055_160_977_102_4,
        0.031_257_260_048_9,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
    ],
    [
        0.0,
        0.771_035_405_688,
        0.0,
        0.0,
        0.260_632_376_098,
        -0.055_160_977_102_4,
        0.0,
        -0.055_124_029_300_9,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
    ],
    [
        0.0,
        1.0,
        0.0,
        0.0,
        0.281_570_073_085,
        0.031_257_260_048_9,
        -0.055_124_029_300_9,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
    ],
    [
        0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
        0.0, 0.0, 0.0, 0.0,
    ],
    [
        0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
        0.0, 0.0, 0.0, 0.0,
    ],
    [
        0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
        0.0, 0.0, 0.0, 0.0,
    ],
    [
        0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
        0.0, 0.0, 0.0, 0.0,
    ],
    [
        0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
        0.0, 0.0, 0.0, 0.0,
    ],
    [
        0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
        0.0, 0.0, 0.0, 0.0,
    ],
    [
        0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
        0.0, 0.0, 0.0, 0.0,
    ],
    [
        0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
        0.0, 0.0, 0.0, 0.0,
    ],
    [
        0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
        0.0, 0.0, 0.0, 0.0,
    ],
    [
        0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
        0.0, 0.0, 0.0, 0.0,
    ],
    [
        0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
        0.0, 0.0, 0.0, 0.0,
    ],
    [
        0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
        0.0, 0.0, 0.0, 0.0,
    ],
    [
        0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
        0.0, 0.0, 0.0, 0.0,
    ],
    [
        0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
        0.0, 0.0, 0.0, 0.0,
    ],
];

const MNUMB: [[usize; MAXFLDS + 1]; MAXFLDS + 1] = [
    [
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
    ],
    [
        0, 0, 3, 4, 1, 2, 10, 10, 0, 0, 0, 0, 0, 0, 0, 7, 0, 0, 0, 0, 0, 0,
    ],
    [
        0, 0, 0, 5, 6, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
    ],
    [
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
    ],
    [
        0, 0, 0, 0, 0, 10, 10, 10, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
    ],
    [
        0, 0, 0, 0, 0, 0, 10, 10, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
    ],
    [
        0, 0, 0, 0, 0, 0, 0, 10, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
    ],
    [
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
    ],
    [
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
    ],
    [
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
    ],
    [
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
    ],
    [
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
    ],
    [
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
    ],
    [
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
    ],
    [
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
    ],
    [
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
    ],
    [
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
    ],
    [
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
    ],
    [
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
    ],
    [
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
    ],
    [
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
    ],
    [
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
    ],
];

const N0I: [[f64; 7 + 1]; MAXFLDS + 1] = [
    [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0],
    [
        0.0,
        33.035_831_495_901_75,
        -15_999.763_271_451_28,
        3.000_893_715_054_907,
        0.763_153_487_858_278_9,
        0.004_600_021_023_583_939,
        8.744_359_964_553_372,
        -4.469_230_425_828_604,
    ],
    [
        0.0,
        20.765_049_294_458_15,
        -2_801.740_514_218_428,
        2.500_321_427_277_643,
        0.137_320_627_599_684,
        -0.146_600_670_012_479_5,
        0.900_664_116_326_328_4,
        0.0,
    ],
    [
        0.0,
        23.855_802_530_200_13,
        -4_902.192_557_963_652,
        2.500_031_425_952_244,
        2.044_529_344_160_399,
        -1.060_444_846_575_946,
        2.033_669_294_526_459,
        0.013_930_063_664_896_58,
    ],
    [
        0.0,
        39.927_488_403_002_9,
        -23_639.759_688_706_04,
        3.002_643_723_053_009,
        4.339_409_832_506_502,
        1.237_225_654_521_418,
        13.197_460_316_662_3,
        -6.019_917_512_970_157,
    ],
    [
        0.0,
        47.906_561_679_948_57,
        -31_236.776_909_531_97,
        3.029_403_845_355_424,
        6.605_720_190_277_867,
        3.197_014_611_390_838,
        19.192_187_714_505_5,
        -8.372_708_265_984_9,
    ],
    [
        0.0,
        37.499_221_415_037_35,
        -38_525.677_472_165_12,
        3.067_154_017_885_922,
        8.975_791_022_268_16,
        5.251_584_001_437_493,
        25.142_414_908_968_36,
        16.138_873_759_873_15,
    ],
    [
        0.0,
        39.729_805_949_530_15,
        -38_957.986_017_954_99,
        3.339_455_262_390_684,
        9.448_973_184_863_693,
        6.894_091_508_228_063,
        24.461_911_798_849_04,
        14.782_467_560_658_09,
    ],
    [
        0.0,
        46.369_644_725_740_98,
        -51_198.542_091_255_41,
        3.000_013_711_033_004,
        11.761_853_755_475_99,
        20.110_191_910_081_6,
        33.168_951_592_837_16,
        0.0,
    ],
    [
        0.0,
        45.875_827_098_834_7,
        -45_216.035_289_264_31,
        3.000_013_711_033_004,
        8.950_470_906_547_043,
        21.836_099_798_038_89,
        33.403_352_664_125_88,
        0.0,
    ],
    [
        0.0,
        50.194_647_827_242_35,
        -52_747.072_888_542_02,
        3.000_013_711_033_004,
        11.697_753_462_516_92,
        26.814_322_550_127_06,
        38.616_576_490_244_96,
        0.0,
    ],
    [
        0.0,
        55.273_815_470_681_31,
        -57_105.070_185_999_26,
        3.000_013_711_033_004,
        13.726_662_735_288_54,
        30.470_839_261_591_12,
        43.556_299_066_374_87,
        0.0,
    ],
    [
        0.0,
        60.455_832_184_173_79,
        -60_547.039_206_910_97,
        3.000_013_711_033_004,
        15.686_571_692_706_4,
        33.803_054_490_892_51,
        48.173_320_167_654_66,
        0.0,
    ],
    [
        0.0,
        65.294_013_966_229_44,
        -66_600.431_392_871_22,
        3.000_013_711_033_004,
        18.024_182_376_343_3,
        38.123_674_237_522_24,
        53.341_743_789_022_3,
        0.0,
    ],
    [
        0.0,
        69.136_654_058_337_56,
        -74_131.792_273_626_43,
        3.000_013_711_033_004,
        21.006_996_008_766_4,
        43.493_298_778_443_18,
        58.365_966_751_346_3,
        0.0,
    ],
    [
        0.0,
        16.272_523_792_163_51,
        -5_836.969_010_194_389,
        1.479_066_759_813_491,
        0.958_064_378_664_093_2,
        0.454_442_076_947_279_4,
        1.560_397_131_519_596,
        -1.375_606_286_965_666,
    ],
    [
        0.0,
        19.999_055_243_617_58,
        -2_318.331_922_884_809,
        2.501_471_432_533_539,
        1.075_584_915_770_959,
        1.013_344_631_312_728,
        0.0,
        0.0,
    ],
    [
        0.0,
        20.655_209_932_456_74,
        -2_635.254_797_324_852,
        2.500_561_428_374_526,
        1.028_654_701_284_7,
        0.004_930_022_531_797_57,
        0.0,
        0.0,
    ],
    [
        0.0,
        24.776_186_826_654_06,
        -7_766.767_211_996_358,
        3.003_933_728_948_753,
        0.010_590_048_399_946_5,
        0.987_634_513_809_175_1,
        3.069_054_026_569_577,
        0.0,
    ],
    [
        0.0,
        24.780_454_196_157_3,
        -6_069.062_243_935_537,
        3.000_013_711_033_004,
        3.119_434_256_823_524,
        1.002_434_581_450_271,
        0.0,
        0.0,
    ],
    [
        0.0,
        13.243_702_139_468_89,
        -745.377_043_972_245,
        1.500_006_855_516_502,
        0.0,
        0.0,
        0.0,
        0.0,
    ],
    [
        0.0,
        13.243_702_139_468_89,
        -745.377_043_972_245,
        1.500_006_855_516_502,
        0.0,
        0.0,
        0.0,
        0.0,
    ],
];

const TH0I: [[f64; 7 + 1]; MAXFLDS + 1] = [
    [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0],
    [0.0, 0.0, 0.0, 0.0, 820.659, 178.41, 1062.82, 1090.53],
    [0.0, 0.0, 0.0, 0.0, 662.738, 680.562, 1740.06, 0.0],
    [0.0, 0.0, 0.0, 0.0, 919.306, 865.07, 483.553, 341.109],
    [0.0, 0.0, 0.0, 0.0, 559.314, 223.284, 1031.38, 1071.29],
    [0.0, 0.0, 0.0, 0.0, 479.856, 200.893, 955.312, 1027.29],
    [0.0, 0.0, 0.0, 0.0, 438.27, 198.018, 1905.02, 893.765],
    [0.0, 0.0, 0.0, 0.0, 468.27, 183.636, 1914.1, 903.185],
    [0.0, 0.0, 0.0, 0.0, 292.503, 910.237, 1919.37, 0.0],
    [0.0, 0.0, 0.0, 0.0, 178.67, 840.538, 1774.25, 0.0],
    [0.0, 0.0, 0.0, 0.0, 182.326, 859.207, 1826.59, 0.0],
    [0.0, 0.0, 0.0, 0.0, 169.789, 836.195, 1760.46, 0.0],
    [0.0, 0.0, 0.0, 0.0, 158.922, 815.064, 1693.07, 0.0],
    [0.0, 0.0, 0.0, 0.0, 156.854, 814.882, 1693.79, 0.0],
    [0.0, 0.0, 0.0, 0.0, 164.947, 836.264, 1750.24, 0.0],
    [0.0, 0.0, 0.0, 0.0, 228.734, 326.843, 1651.71, 1671.69],
    [0.0, 0.0, 0.0, 0.0, 2235.71, 1116.69, 0.0, 0.0],
    [0.0, 0.0, 0.0, 0.0, 1550.45, 704.525, 0.0, 0.0],
    [0.0, 0.0, 0.0, 0.0, 268.795, 1141.41, 2507.37, 0.0],
    [0.0, 0.0, 0.0, 0.0, 1833.63, 847.181, 0.0, 0.0],
    [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0],
    [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0],
];

const BVIJ: [[f64; MAXFLDS + 1]; MAXFLDS + 1] = [
    [
        0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
        0.0, 0.0, 0.0, 0.0,
    ],
    [
        0.0,
        1.0,
        0.997_444_388_876_776_1,
        0.999_036_376_254_597_2,
        0.995_101_744_961_154,
        1.009_677_440_604_785,
        1.022_607_122_322_391,
        0.958_648_504_406_064_9,
        1.0,
        0.899_330_016_499_214_5,
        0.917_793_303_537_906_3,
        0.925_541_801_427_790_5,
        0.989_508_867_256_803_6,
        1.005_712_709_541_13,
        1.067_267_286_718_309,
        1.0,
        1.0,
        0.994_688_615_493_556,
        1.025_729_747_409_682,
        1.025_356_910_993_233,
        1.0,
        1.070_459_772_838_407,
    ],
    [
        0.0,
        0.0,
        1.0,
        0.956_082_346_279_194,
        0.958_206_383_303_708_2,
        0.949_503_458_941_951_8,
        0.973_016_189_674_588_9,
        0.992_180_565_944_412_1,
        1.0,
        1.0,
        1.0,
        1.0,
        1.0,
        1.0,
        1.0,
        0.945_818_617_453_164_2,
        0.999_043_768_703_932_9,
        1.0,
        1.0,
        0.828_817_688_612_274,
        0.939_932_295_646_112_9,
        1.008_350_182_988_954,
    ],
    [
        0.0,
        0.0,
        0.0,
        1.0,
        1.005_057_815_251_416,
        0.993_805_630_379_183_9,
        1.158_963_954_637_742,
        1.380_063_226_207_812,
        1.125_282_009_493_955,
        1.049_214_044_935_004,
        1.0,
        1.453_157_863_037_441,
        1.053_023_582_083_213,
        1.0,
        1.000_302_286_840_882,
        0.817_473_043_681_181_2,
        1.0,
        1.0,
        0.900_707_213_313_409_6,
        0.821_978_979_578_958,
        0.716_812_092_547_248_8,
        1.016_855_288_847_735,
    ],
    [
        0.0,
        0.0,
        0.0,
        0.0,
        1.0,
        0.995_220_279_123_354_6,
        1.0,
        0.998_315_120_303_412_1,
        1.0,
        0.987_739_828_090_318_1,
        1.0,
        1.0,
        1.014_995_248_806_515,
        1.0,
        0.991_371_210_744_882_7,
        0.856_304_401_164_543_2,
        1.0,
        1.0,
        1.0,
        1.021_752_845_155_132,
        1.0,
        1.0,
    ],
    [
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        1.0,
        0.998_486_864_827_977_2,
        0.999_591_777_669_873_4,
        1.082_555_532_066_385,
        1.091_856_617_281_364,
        1.0,
        1.0,
        1.0,
        1.0,
        0.968_461_129_599_267_6,
        1.0,
        1.0,
        1.0,
        1.0,
        0.877_615_260_044_265_9,
        1.0,
        1.0,
    ],
    [
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        1.0,
        0.998_241_395_852_736_6,
        1.0,
        1.0,
        1.0,
        1.0,
        1.0,
        1.0,
        1.0,
        1.0,
        1.0,
        1.0,
        1.0,
        1.026_157_717_237_014,
        1.0,
        1.0,
    ],
    [
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        1.0,
        1.0,
        1.0,
        1.0,
        1.0,
        1.0,
        1.0,
        0.954_435_147_779_072_9,
        1.0,
        1.0,
        1.0,
        1.0,
        0.824_669_516_813_864_6,
        1.0,
        1.0,
    ],
    [
        0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0,
        1.0, 1.0, 1.0, 1.0,
    ],
    [
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        1.0,
        1.0,
        1.0,
        1.0,
        1.0,
        1.0,
        1.0,
        1.0,
        1.0,
        1.0,
        0.969_463_159_521_919_2,
        1.0,
        1.0,
    ],
    [
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        1.0,
        1.0,
        1.0,
        1.0,
        1.003_035_041_381_009,
        1.0,
        1.0,
        1.0,
        1.0,
        0.569_230_953_300_185_7,
        1.0,
        1.0,
    ],
    [
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        1.0,
        1.0,
        1.0,
        1.0,
        1.0,
        1.0,
        1.0,
        1.0,
        0.687_186_558_990_203,
        1.0,
        1.0,
    ],
    [
        0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0,
        1.0, 1.0, 1.0, 1.0,
    ],
    [
        0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 1.0, 1.0, 1.0, 1.0,
        1.0, 1.0, 1.0, 1.0,
    ],
    [
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        1.0,
        2.874_240_043_417_658,
        1.0,
        1.0,
        1.0,
        0.950_991_178_956_070_8,
        1.0,
        1.0,
    ],
    [
        0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 1.0, 1.0,
        1.0, 1.0, 1.0, 1.0,
    ],
    [
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        1.0,
        1.0,
        1.0,
        1.0,
        1.0,
        0.999_493_758_086_441_5,
    ],
    [
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        1.0,
        1.0,
        0.633_075_459_397_593_8,
        1.0,
        1.0,
    ],
    [
        0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
        1.0, 1.0, 1.0, 1.0,
    ],
    [
        0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
        0.0, 1.0, 1.0, 1.0,
    ],
    [
        0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
        0.0, 0.0, 1.0, 1.0,
    ],
    [
        0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
        0.0, 0.0, 0.0, 1.0,
    ],
];

const GVIJ: [[f64; MAXFLDS + 1]; MAXFLDS + 1] = [
    [
        0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
        0.0, 0.0, 0.0, 0.0,
    ],
    [
        0.0,
        0.098_625_722_368_187_76,
        0.095_133_493_812_036_16,
        0.096_578_065_843_442_47,
        0.121_067_150_981_627_4,
        0.149_629_560_902_829_6,
        0.177_142_878_531_499_7,
        0.168_549_571_767_053_5,
        0.246_023_759_456_518_3,
        0.197_246_344_040_166_7,
        0.206_928_570_333_252,
        0.251_286_096_120_934_1,
        0.270_120_969_792_858_5,
        0.302_011_423_603_743_2,
        0.332_721_926_904_087_9,
        0.083_288_329_374_180_65,
        0.085_374_935_369_851_47,
        0.095_686_188_154_656_49,
        0.120_849_666_248_266_4,
        0.103_620_728_234_878_7,
        0.067_170_435_977_880_04,
        0.090_333_316_493_750_66,
    ],
    [
        0.0,
        0.0,
        0.089_414_247_266_159_39,
        0.093_976_878_290_626_52,
        0.117_552_694_273_574_4,
        0.144_708_115_708_046_5,
        0.173_161_981_855_694_2,
        0.180_587_404_870_933_2,
        0.203_132_699_819_361_4,
        0.191_849_542_767_128,
        0.236_247_631_178_835_2,
        0.305_713_007_440_63,
        0.278_279_818_587_633_2,
        0.280_241_889_768_157_6,
        0.271_560_058_994_166_1,
        0.073_244_004_764_540_85,
        0.080_851_216_033_617_49,
        0.091_572_113_755_441,
        0.078_142_014_899_848_3,
        0.107_222_008_773_53,
        0.065_347_633_141_440_51,
        0.082_298_305_773_323_84,
    ],
    [
        0.0,
        0.0,
        0.0,
        0.094_117_835_755_118_8,
        0.122_154_704_865_701_8,
        0.146_706_031_228_471_7,
        0.189_768_243_875_887_7,
        0.231_887_380_214_763_9,
        0.212_840_930_480_359_3,
        0.198_634_807_894_710_2,
        0.171_534_431_724_811_6,
        0.311_475_305_284_069_2,
        0.270_827_762_158_326,
        0.252_442_496_313_592_6,
        0.327_183_634_074_859_9,
        0.083_128_424_899_598_18,
        0.083_312_516_354_425_94,
        0.093_138_458_258_295_96,
        0.107_420_354_855_897_8,
        0.089_237_461_600_278_98,
        0.054_357_340_421_292_35,
        0.087_151_255_876_559_04,
    ],
    [
        0.0,
        0.0,
        0.0,
        0.0,
        0.145_542_303_970_824_6,
        0.171_439_365_674_31,
        0.198_181_803_990_479_8,
        0.196_268_445_120_878_2,
        0.225_629_605_147_272_2,
        0.222_215_611_620_290_8,
        0.281_233_001_051_548_7,
        0.278_503_903_183_360_8,
        0.305_134_780_963_871_4,
        0.349_014_245_970_574_2,
        0.354_589_973_363_468_3,
        0.103_586_791_293_512_1,
        0.105_370_452_957_861_6,
        0.140_361_310_558_919_3,
        0.093_725_416_701_403_04,
        0.125_355_370_238_732_5,
        0.094_796_404_930_836_16,
        0.106_143_269_913_884_8,
    ],
    [
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.199_998_276_494_852_5,
        0.228_347_099_212_782_2,
        0.227_126_142_952_769_1,
        0.259_064_005_174_434_3,
        0.267_951_554_304_686_6,
        0.292_148_006_852_644_2,
        0.325_226_634_163_791_7,
        0.355_365_011_999_465_4,
        0.416_261_828_552_551_7,
        0.381_009_711_454_573_6,
        0.130_588_950_813_983_3,
        0.126_292_961_559_656_3,
        0.154_249_960_990_131,
        0.114_453_829_026_461_5,
        0.135_458_363_103_943_5,
        0.114_337_326_622_726_6,
        0.127_164_837_789_916,
    ],
    [
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.259_057_764_322_064_2,
        0.256_954_583_745_802_2,
        0.282_387_335_133_217_1,
        0.285_021_942_414_396_4,
        0.314_311_796_510_656_7,
        0.345_481_338_946_24,
        0.372_671_751_642_764_8,
        0.405_771_976_030_558_7,
        0.434_406_931_006_615_5,
        0.162_996_084_277_148_5,
        0.147_245_086_809_324_3,
        0.175_611_831_444_615_2,
        0.132_630_106_157_242_4,
        0.166_039_699_365_105_2,
        0.133_979_466_599_228_5,
        0.148_210_795_747_834_4,
    ],
    [
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.255_100_948_047_163_4,
        0.280_408_927_214_094_1,
        0.287_244_915_596_137_9,
        0.319_613_410_520_719_6,
        0.342_222_953_982_071_1,
        0.375_168_395_630_833_1,
        0.403_793_567_987_235_9,
        0.408_721_807_026_147_1,
        0.173_480_435_902_425_4,
        0.145_884_809_258_596_8,
        0.173_633_423_313_345_9,
        0.160_739_068_756_283_4,
        0.154_208_454_333_291_1,
        0.132_702_294_121_291_5,
        0.178_363_100_030_283_5,
    ],
    [
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.305_716_906_144_909_8,
        0.308_351_513_337_592,
        0.337_641_367_610_972_4,
        0.368_810_910_098_109_8,
        0.396_001_322_433_529_5,
        0.429_101_546_917_779_1,
        0.457_736_501_832_258_1,
        0.186_325_655_154_291_1,
        0.162_902_280_326_008_8,
        0.198_941_402_307_542_1,
        0.147_250_852_777_724_3,
        0.152_715_353_033_351_2,
        0.148_697_474_158_183,
        0.163_935_214_060_532_6,
    ],
    [
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.310_986_120_730_482,
        0.340_275_974_886_206_8,
        0.371_445_517_256_474_1,
        0.419_274_119_431_907_3,
        0.434_911_763_500_412_4,
        0.451_010_855_699_546_8,
        0.188_960_262_522_072_1,
        0.164_630_126_146_966_4,
        0.201_576_009_695_613_8,
        0.142_417_076_615_553_9,
        0.195_661_444_099_798_2,
        0.150_323_533_772_074_7,
        0.165_670_343_303_836,
    ],
    [
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.369_565_828_982_581_1,
        0.400_529_147_739_814_7,
        0.427_925_783_916_199_7,
        0.464_359_738_330_806_9,
        0.486_903_116_002_920_9,
        0.220_511_785_735_017_1,
        0.183_375_669_131_334_3,
        0.230_865_863_767_620_4,
        0.194_744_057_122_789_9,
        0.206_936_010_017_032_7,
        0.167_986_329_953_974_7,
        0.184_493_338_652_349,
    ],
    [
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.431_904_913_762_940_9,
        0.461_661_186_411_043_5,
        0.490_395_127_131_934_9,
        0.517_263_608_143_118_8,
        0.227_285_009_452_853_1,
        0.202_536_768_767_111_3,
        0.262_035_406_199_415_3,
        0.184_397_379_698_649_6,
        0.203_279_959_282_160_6,
        0.186_077_668_227_651_2,
        0.203_730_920_493_201_2,
    ],
    [
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.486_285_738_717_543_4,
        0.519_385_963_043_583_5,
        0.547_088_518_050_974_6,
        0.276_610_071_574_800_6,
        0.218_717_081_818_728_1,
        0.289_225_818_575_585_7,
        0.119_662_445_397_562_3,
        0.242_755_971_577_449_2,
        0.201_380_340_777_504_2,
        0.219_973_952_305_339_9,
    ],
    [
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.552_486_187_845_303_9,
        0.581_121_142_522_951_9,
        0.309_710_296_061_872_4,
        0.237_860_200_593_475_5,
        0.322_326_043_212_524_8,
        0.217_635_940_194_718_2,
        0.285_082_944_972_181_5,
        0.219_512_218_090_115_5,
        0.239_189_308_865_779_5,
    ],
    [
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.609_756_097_560_975_6,
        0.468_138_795_864_401_7,
        0.254_005_211_926_358_7,
        0.238_801_692_180_450_1,
        0.128_401_541_832_529_9,
        0.320_533_488_499_416_8,
        0.234_825_032_463_424_7,
        0.255_393_746_785_770_9,
    ],
    [
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.066_934_404_283_801_87,
        0.070_101_798_504_477_41,
        0.088_456_010_569_906_05,
        0.061_277_192_964_608_01,
        0.081_542_719_064_971_29,
        0.062_084_420_794_103_17,
        0.070_690_964_258_949_23,
    ],
    [
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.073_367_571_533_382_25,
        0.082_409_741_309_062_03,
        0.073_465_961_850_719_96,
        0.085_152_093_135_497_74,
        0.065_098_083_417_719_75,
        0.073_505_545_272_719_9,
    ],
    [
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.092_165_898_617_511_52,
        0.072_557_337_299_267_25,
        0.083_382_082_821_044_81,
        0.073_460_599_707_612_89,
        0.096_333_233_634_713_09,
    ],
    [
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.055_948_074_533_839_15,
        0.076_191_321_570_660_86,
        0.056_707_896_819_804_31,
        0.067_348_513_016_338_36,
    ],
    [
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.098_135_426_889_106_97,
        0.076_001_723_841_027_73,
        0.085_822_706_464_593_79,
    ],
    [
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.057_474_567_503_879_53,
        0.065_658_908_140_010_21,
    ],
    [
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.074_585_511_573_333_55,
    ],
];

const BTIJ: [[f64; MAXFLDS + 1]; MAXFLDS + 1] = [
    [
        0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
        0.0, 0.0, 0.0, 0.0,
    ],
    [
        0.0,
        1.0,
        0.996_201_274_447_368_8,
        1.045_760_847_547_76,
        0.992_686_437_173_633_9,
        0.979_467_106_104_893_1,
        0.961_018_981_461_851_5,
        0.988_383_751_673_508_1,
        1.0,
        0.984_317_025_862_625_6,
        0.964_019_205_395_971_3,
        0.955_372_393_883_277_8,
        0.916_756_048_962_226_3,
        0.898_167_074_243_799_4,
        0.879_427_245_310_619_3,
        1.0,
        1.0,
        0.974_981_928_491_239_8,
        1.130_679_010_535_891,
        1.022_303_050_787_581,
        1.0,
        0.981_990_387_032_227_1,
    ],
    [
        0.0,
        0.0,
        1.0,
        1.011_823_803_472_132,
        1.015_401_706_807_559,
        1.005_361_826_090_574,
        0.985_787_123_569_696_8,
        0.989_060_550_658_074_7,
        1.0,
        1.0,
        1.0,
        1.0,
        1.0,
        0.914_661_652_382_302_6,
        0.917_638_404_749_195_8,
        0.895_170_183_650_429_7,
        0.994_389_070_790_166_9,
        1.0,
        1.0,
        1.009_406_750_298_678,
        0.480_067_125_512_625_3,
        0.998_140_551_192_044_7,
    ],
    [
        0.0,
        0.0,
        0.0,
        1.0,
        1.027_934_702_719_095,
        1.068_371_416_575_41,
        1.047_224_395_384_351,
        1.036_672_193_386_368,
        1.038_729_823_111_436,
        1.054_730_632_930_632,
        1.0,
        1.023_752_023_121_105,
        1.060_263_102_417_008,
        1.015_436_354_877_504,
        1.040_458_732_428_864,
        0.887_967_349_904_837_9,
        1.0,
        1.0,
        0.994_751_315_306_562,
        1.032_326_273_851_984,
        0.590_404_182_284_416_9,
        0.993_037_886_124_456_8,
    ],
    [
        0.0,
        0.0,
        0.0,
        0.0,
        1.0,
        0.992_413_830_325_693_5,
        1.0,
        0.998_261_863_936_346_9,
        1.0,
        0.997_379_610_862_591,
        1.0,
        1.0,
        0.968_390_363_957_066,
        1.0,
        0.942_681_881_175_999_7,
        0.870_432_705_556_168_5,
        1.0,
        1.0,
        1.0,
        0.980_490_799_868_601_2,
        1.0,
        1.0,
    ],
    [
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        1.0,
        0.996_028_546_959_240_8,
        1.000_620_674_279_263,
        0.988_760_609_705_580_7,
        0.992_980_404_108_328_4,
        1.0,
        1.0,
        1.0,
        1.0,
        0.970_877_638_725_300_3,
        1.0,
        1.0,
        1.0,
        1.0,
        0.985_202_264_070_485_1,
        1.0,
        1.0,
    ],
    [
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        1.0,
        0.999_844_924_012_606_6,
        1.0,
        1.0,
        1.0,
        1.0,
        1.0,
        1.0,
        1.0,
        1.0,
        1.0,
        1.0,
        1.0,
        0.949_748_770_607_100_3,
        1.0,
        1.0,
    ],
    [
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        1.0,
        1.0,
        1.0,
        1.0,
        1.0,
        1.0,
        1.0,
        0.987_416_608_471_285,
        1.0,
        1.0,
        1.0,
        1.0,
        0.972_122_812_569_449_1,
        1.0,
        1.0,
    ],
    [
        0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0,
        1.0, 1.0, 1.0, 1.0,
    ],
    [
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        1.0,
        1.0,
        1.0,
        1.0,
        1.0,
        1.0,
        1.0,
        1.0,
        1.0,
        1.0,
        0.925_456_796_568_235_9,
        1.0,
        1.0,
    ],
    [
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        1.0,
        1.0,
        1.0,
        1.0,
        0.995_287_584_833_820_2,
        1.0,
        1.0,
        1.0,
        1.0,
        0.971_981_286_692_378_7,
        1.0,
        1.0,
    ],
    [
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        1.0,
        1.0,
        1.0,
        1.0,
        1.0,
        1.0,
        1.0,
        1.0,
        0.977_997_214_742_632,
        1.0,
        1.0,
    ],
    [
        0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0,
        1.0, 1.0, 1.0, 1.0,
    ],
    [
        0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 1.0, 1.0, 1.0, 1.0,
        1.0, 1.0, 1.0, 1.0,
    ],
    [
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        1.0,
        1.133_837_562_661_612,
        1.0,
        1.101_648_891_523_215,
        0.804_900_135_122_903_8,
        0.946_906_898_054_336_6,
        1.0,
        1.0,
    ],
    [
        0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 1.0, 1.0,
        1.0, 1.0, 1.0, 1.0,
    ],
    [
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        1.0,
        1.0,
        1.0,
        1.0,
        1.0,
        1.000_046_206_533_749,
    ],
    [
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        1.0,
        1.0,
        1.051_725_596_885_534,
        1.0,
        1.0,
    ],
    [
        0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
        1.0, 1.0, 1.0, 1.0,
    ],
    [
        0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
        0.0, 1.0, 1.0, 1.0,
    ],
    [
        0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
        0.0, 0.0, 1.0, 1.0,
    ],
    [
        0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
        0.0, 0.0, 0.0, 1.0,
    ],
];

const GTIJ: [[f64; MAXFLDS + 1]; MAXFLDS + 1] = [
    [
        0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
        0.0, 0.0, 0.0, 0.0,
    ],
    [
        0.0,
        190.564,
        151.570_147_988_173_6,
        240.196_046_603_165_1,
        252.274_820_131_493_7,
        288.652_309_907_548_5,
        317.318_455_699_613_3,
        331.530_711_111_505_1,
        352.135_440_823_683_6,
        370.784_127_000_142_7,
        406.402_115_624_185_6,
        432.701_006_110_287_2,
        457.053_959_702_641_6,
        487.604_671_752_71,
        504.567_599_178_678_1,
        107.573_991_329_273_3,
        163.057_867_108_428_7,
        155.146_178_058_228_4,
        289.687_738_412_709_7,
        259.129_371_659_019_4,
        99.421_923_036_735_12,
        166.218_143_769_241_7,
    ],
    [
        0.0,
        0.0,
        126.192,
        218.273_425_689_361,
        217.306_965_184_814_6,
        260.203_846_144_132_5,
        289.308_783_977_365_2,
        300.578_923_555_517_3,
        333.039_684_807_440_5,
        345.475_676_075_968_7,
        372.784_596_732_709,
        397.088_429_483_295_8,
        464.582_525_668_831_6,
        458.205_126_519_860_2,
        487.333_566_973_837_8,
        71.989_241_554_759_73,
        138.606_445_425_442_1,
        128.631_783_260_774_5,
        276.845_963_076_097_1,
        209.320_455_367_382_9,
        26.111_410_211_921_85,
        136.395_527_287_525_4,
    ],
    [
        0.0,
        0.0,
        0.0,
        304.128_2,
        278.349_613_161_909_6,
        315.023_370_975_912,
        335.162_841_549_422_2,
        333.705_391_360_057_9,
        366.560_473_210_836_7,
        380.091_785_835_649_9,
        408.190_755_691_022_4,
        429.019_537_786_016_4,
        460.364_447_848_114_4,
        488.775_432_616_089_3,
        506.441_515_868_393_9,
        168.796_522_287_274_4,
        216.833_344_020_240_6,
        201.013_613_101_202_7,
        343.104_175_002_480_4,
        316.934_343_085_291_7,
        97.964_609_025_244_19,
        224.202_340_996_615_1,
    ],
    [
        0.0,
        0.0,
        0.0,
        0.0,
        305.322,
        339.683_277_970_995_1,
        364.612_318_395_696_9,
        372.503_001_190_061_1,
        382.835_999_844_791_7,
        403.411_145_251_601_4,
        430.058_259_476_988_1,
        460.728_368_874_730_6,
        479.470_433_993_767_8,
        449.935_999_966_161_9,
        521.659_808_690_4,
        178.633_426_235_147,
        217.258_497_164_092_5,
        215.350_144_480_998_3,
        444.491_445_263_010_6,
        301.699_447_408_447,
        39.827_620_900_576_02,
        214.494_886_218_762_8,
    ],
    [
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        369.825,
        389.619_876_908_913_5,
        399.567_380_174_618_8,
        411.628_460_380_588_1,
        418.781_654_109_911_3,
        444.483_251_724_503_6,
        469.304_642_456_162_8,
        488.082_364_018_104_1,
        520.481_221_712_897_1,
        537.302_377_459_437_8,
        255.727_865_724_955,
        239.108_962_347_712_9,
        265.456_928_259_797_4,
        293.684_121_732_059_2,
        333.979_489_823_783_4,
        43.833_227_379_466_36,
        236.067_405_151_579_5,
    ],
    [
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        407.817,
        416.945_345_945_802_8,
        434.083_500_063_419_4,
        438.758_500_146_207_3,
        457.818_499_864_190_2,
        473.973_500_206_221_4,
        488.568_499_849_367,
        501.183_500_125_529_2,
        512.758_499_810_912,
        220.503_500_017_977_6,
        251.090_559_589_563_2,
        270.338_500_015_977_1,
        513.708_817_747_953_4,
        356.245_912_039_186_2,
        46.029_682_381_046_25,
        247.896_591_906_786_8,
    ],
    [
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        425.125,
        442.737_500_122_883_7,
        447.814_938_721_707_9,
        468.891_096_111_637,
        489.388_473_029_385_5,
        508.291_184_946_544_3,
        509.837_499_809_891_4,
        548.148_240_839_282_5,
        298.062_680_480_104_1,
        256.363_412_707_429_9,
        278.992_499_897_548_7,
        322.834_311_071_452_8,
        363.677_088_246_845_7,
        46.996_296_795_598_7,
        315.122_450_578_332_2,
    ],
    [
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        460.35,
        465.024_999_778_386,
        484.085_000_164_041_5,
        500.240_000_165_009_2,
        514.834_999_877_052_8,
        527.449_999_975_204_8,
        539.024_999_907_433,
        246.770_000_019_091,
        266.772_952_620_763_2,
        296.605_000_068_418_2,
        545.793_590_654_928_8,
        407.245_442_229_103,
        48.904_563_744_092_43,
        263.379_498_917_436_6,
    ],
    [
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        469.7,
        488.759_999_762_539_1,
        504.915_000_190_436_1,
        525.608_893_801_269,
        583.103_991_171_831_1,
        565.053_287_389_948,
        251.444_999_986_778_6,
        269.468_498_158_875_7,
        301.280_000_016_606_9,
        246.802_048_210_432_4,
        386.232_949_986_275_4,
        49.398_708_586_358_81,
        266.040_756_088_235_5,
    ],
    [
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        507.82,
        523.601_663_232_348_9,
        538.569_999_908_750_8,
        579.900_747_724_270_4,
        574.920_574_338_087_7,
        392.227_147_980_458_8,
        280.189_994_289_589_2,
        320.339_999_906_665_5,
        326.566_210_866_854_2,
        410.287_900_604_373_7,
        51.364_163_051_684_19,
        276.625_870_699_036_4,
    ],
    [
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        540.13,
        553.863_707_361_212_5,
        567.338_864_171_355_6,
        578.902_362_673_500_6,
        424.321_091_901_073_1,
        288.966_083_390_421_4,
        336.495_000_092_165_9,
        591.198_750_404_633_4,
        449.918_898_068_286_9,
        52.972_987_352_045_76,
        285.290_324_599_345_6,
    ],
    [
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        569.32,
        581.935_000_162_335_3,
        597.278_410_109_460_9,
        301.254_999_962_992_2,
        296.671_578_348_853_6,
        351.090_000_045_770_4,
        401.853_825_430_948_4,
        460.883_165_238_219_5,
        54.385_551_353_277_6,
        292.897_802_723_065_9,
    ],
    [
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        594.55,
        606.124_999_839_865_3,
        313.870_000_006_970_3,
        303.173_971_920_414,
        363.705_000_059_025_9,
        620.266_819_038_387_7,
        511.752_131_742_767_5,
        55.577_563_953_451_57,
        299.317_483_368_412_7,
    ],
    [
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        617.7,
        577.229_986_231_689_6,
        309.019_953_239_269,
        542.300_428_206_455_3,
        419.971_857_684_438_9,
        515.588_884_486_030_2,
        56.649_243_684_271_72,
        305.089_101_575_261_1,
    ],
    [
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        33.19,
        71.631_055_066_919_12,
        91.473_186_945_338_13,
        146.550_729_237_353_2,
        111.279_778_037_161_8,
        13.131_336_832_173_6,
        70.719_880_726_709_36,
    ],
    [
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        154.595,
        143.316_055_276_441_4,
        305.144_073_078_044_1,
        240.165_348_249_908_8,
        28.340_208_247_294_16,
        151.171_394_957_527_4,
    ],
    [
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        132.86,
        293.211_825_409_549_2,
        233.523_371_243_601_1,
        26.272_562_836_541_09,
        135.014_868_008_322_6,
    ],
    [
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        647.096,
        462.163_871_373_824,
        57.981_530_238_516_46,
        334.416_846_789_014,
    ],
    [
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        373.1,
        44.026_883_037_526_05,
        237.110_353_422_198_7,
    ],
    [
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        0.0,
        5.195_3,
        27.979_709_989_562_07,
    ],
    [
        0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
        0.0, 0.0, 0.0, 150.687,
    ],
];

pub struct Gerg2008 {
    pub dp_dd: f64,
    pub d2p_dd2: f64,
    pub d2p_dtd: f64,
    pub dp_dt: f64,
    pub u: f64,
    pub h: f64,
    pub s: f64,
    pub cv: f64,
    pub cp: f64,
    pub w: f64,
    pub g: f64,
    pub jt: f64,
    pub kappa: f64,
    pub a: f64,
    pub mm: f64,
    pub t: f64,
    pub p: f64,
    pub d: f64,
    pub z: f64,
    pub x: [f64; NC_GERG + 1],

    drold: f64,
    trold: f64,
    told: f64,
    trold2: f64,
    xold: [f64; NC_GERG + 1],
    a0: [f64; 3],
    ar: [[f64; 4]; 4],
    dpddsave: f64,
    taup: [[f64; MAXTRMP + 1]; MAXFLDS + 1],
    taupijk: [[f64; MAXTRMM + 1]; MAXFLDS + 1],
}

impl Default for Gerg2008 {
    fn default() -> Self {
        Gerg2008 {
            dp_dd: 0.0,
            d2p_dd2: 0.0,
            d2p_dtd: 0.0,
            dp_dt: 0.0,
            u: 0.0,
            h: 0.0,
            s: 0.0,
            cv: 0.0,
            cp: 0.0,
            w: 0.0,
            g: 0.0,
            jt: 0.0,
            kappa: 0.0,
            a: 0.0,
            mm: 0.0,
            t: 0.0,
            p: 0.0,
            d: 0.0,
            z: 0.0,
            x: [0.0; NC_GERG + 1],
            xold: [0.0; NC_GERG + 1],
            told: 0.0,
            a0: [0.0; 3],
            ar: [[0.0; 4]; 4],
            dpddsave: 0.0,
            drold: 0.0,
            trold: 0.0,
            trold2: 0.0,
            taup: [[0.0; MAXTRMP + 1]; MAXFLDS + 1],
            taupijk: [[0.0; MAXTRMM + 1]; MAXFLDS + 1],
        }
    }
}

impl Gerg2008 {
    pub fn molarmass(&mut self) {
        self.mm = 0.0;
        for i in 1..=NC_GERG {
            self.mm += self.x[i] * MMI_GERG[i];
        }
    }

    pub fn pressure(&mut self) -> f64 {
        self.alphar(0);
        self.z = 1.0 + self.ar[0][1];
        let p = self.d * RGERG * self.t * self.z;
        self.dpddsave = RGERG * self.t * (1.0 + 2.0 * self.ar[0][1] + self.ar[0][2]);
        p
    }

    pub fn density(&mut self, iflag: i32) {
        let mut nfail: i32 = 0;
        let mut ifail: i32 = 0;
        const TOLR: f64 = 0.000_000_1;

        if self.d < EPSILON {
            self.d = 0.0;
        }

        let (dcx, _tcx) = self.pseudocriticalpoint();

        if self.p > -EPSILON {
            self.d = self.p / RGERG / self.t;
            if iflag == 2 {
                self.d = dcx * 3.0;
            }
        } else {
            self.d = f64::abs(self.d);
        }

        let plog = f64::ln(self.p);
        let mut vlog = f64::ln(self.d);

        for it in 0..50 {
            if vlog < -7.0 || vlog > 100.0 || it == 20 || it == 30 || it == 40 || ifail == 1 {
                //Current state is bad or iteration is taking too long.  Restart with completely different initial state
                ifail = 0;
                if nfail > 2 {
                    // Iteration failed (above loop did not find a solution or checks made below indicate possible 2-phase state)
                    //herr = "Calculation failed to converge in GERG method, ideal gas density returned.";
                    self.d = self.p / RGERG / self.t;
                }
                nfail += 1;
                if nfail == 1 {
                    self.d = dcx * 3.0; // If vapor phase search fails, look for root in liquid region
                } else if nfail == 2 {
                    self.d = dcx * 2.5; // If liquid phase search fails, look for root between liquid and critical regions
                } else if nfail == 3 {
                    self.d = dcx * 2.0; // If search fails, look for root in critical region
                }
                vlog = -f64::ln(self.d);
            }
            self.d = f64::exp(-vlog);
            let p2 = self.pressure();
            if self.dpddsave < EPSILON || p2 < EPSILON {
                // Current state is 2-phase, try locating a different state that is single phase
                let mut vinc = 0.1;
                if self.d > dcx {
                    vinc = -0.1;
                }
                if it > 5 {
                    vinc /= 2.0;
                }
                if it > 10 && it < 20 {
                    vinc /= 5.0;
                }
                vlog += vinc;
            } else {
                // Find the next density with a first order Newton's type iterative scheme, with
                // log(P) as the known variable and log(v) as the unknown property.
                // See AGA 8 publication for further information.
                let dpdlv = -self.d * self.dpddsave; // d(p)/d[log(v)]
                let vdiff = (f64::ln(p2) - plog) * p2 / dpdlv;
                vlog += -vdiff;
                if f64::abs(vdiff) < TOLR {
                    // Check to see if state is possibly 2-phase, and if so restart
                    if self.dpddsave < 0.0 {
                        ifail = 1;
                    } else {
                        self.d = f64::exp(-vlog);

                        // If requested, check to see if point is possibly 2-phase
                        if iflag > 0 {
                            if (self.properties() <= 0.0
                                || self.dp_dd <= 0.0
                                || self.d2p_dtd <= 0.0)
                                || (self.cv <= 0.0 || self.cp <= 0.0 || self.w <= 0.0)
                            {
                                // Iteration failed (above loop did find a solution or checks made below indicate possible 2-phase state)
                                //herr = "Calculation failed to converge in GERG method, ideal gas density returned.";
                                self.d = self.p / RGERG / self.t;
                            }
                            return;
                        }
                        return; // Iteration converged
                    }
                }
            }
        }
        // Iteration failed (above loop did not find a solution or checks made below indicate possible 2-phase state)
        //herr = "Calculation failed to converge in GERG method, ideal gas density returned.";
        self.d = self.p / RGERG / self.t;
    }

    pub fn properties(&mut self) -> f64 {
        self.molarmass();
        self.alpha0();
        self.alphar(1);

        let rt = RGERG * self.t;
        self.z = 1.0 + self.ar[0][1];
        let p = self.d * rt * self.z;
        self.dp_dd = rt * (1.0 + 2.0 * self.ar[0][1] + self.ar[0][2]);
        self.dp_dt = self.d * RGERG * (1.0 + self.ar[0][1] - self.ar[1][1]);
        self.d2p_dtd = RGERG
            * (1.0 + 2.0 * self.ar[0][1] + self.ar[0][2] - 2.0 * self.ar[1][1] - self.ar[1][2]);
        self.a = rt * self.a0[0] + self.ar[0][0];
        self.g = rt * (1.0 + self.ar[0][1] + self.a0[0] + self.ar[0][0]);
        self.u = rt * (self.a0[1] + self.ar[1][0]);
        self.h = rt * (1.0 + self.ar[0][1] + self.a0[1] + self.ar[1][0]);
        self.s = RGERG * (self.a0[1] + self.ar[1][0] - self.a0[0] - self.ar[0][0]);
        self.cv = -RGERG * (self.a0[2] + self.ar[2][0]);
        if self.d > EPSILON {
            self.cp = self.cv + self.t * (self.dp_dt / self.d) * (self.dp_dt / self.d) / self.dp_dd;
            self.d2p_dd2 =
                rt * (2.0 * self.ar[0][1] + 4.0 * self.ar[0][2] + self.ar[0][3]) / self.d;
            self.jt = (self.t / self.d * self.dp_dt / self.dp_dd - 1.0) / self.cp / self.d;
        //  '=(dB/dT*T-B)/Cp for an ideal gas, but dB/dT is not known
        } else {
            self.cp = self.cv + RGERG;
            self.d2p_dd2 = 0.0;
            self.jt = 1E+20;
        }
        self.w = 1000.0 * self.cp / self.cv * self.dp_dd / self.mm;
        if self.w < 0.0 {
            self.w = 0.0;
        }
        self.w = f64::sqrt(self.w);
        self.kappa = f64::powi(self.w, 2) * self.mm / (rt * 1000.0 * self.z);
        p
    }

    fn reducingparameters(&mut self) -> (f64, f64) {
        let mut dr: f64 = 0.0;
        let mut tr: f64 = 0.0;
        let mut vr: f64 = 0.0;
        let mut xij: f64;
        let mut f: f64;
        let mut icheck: i32 = 0;

        // Check to see if a component fraction has changed.  If x is the same as the previous call, then exit.
        for i in 1..=NC_GERG {
            if f64::abs(self.x[i] - self.xold[i]) > 0.000_000_1 {
                icheck = 1;
            }
            self.xold[i] = self.x[i];
        }
        if icheck == 0 {
            return (self.drold, self.trold);
        }
        self.told = 0.0;
        self.trold2 = 0.0;

        // Calculate reducing variables for T and D
        for i in 1..=NC_GERG {
            if self.x[i] > EPSILON {
                f = 1.0;
                for j in i..=NC_GERG {
                    if self.x[j] > EPSILON {
                        xij = f * (self.x[i] * self.x[j]) * (self.x[i] + self.x[j]);
                        vr += xij * GVIJ[i][j] / (BVIJ[i][j] * self.x[i] + self.x[j]);
                        tr += xij * GTIJ[i][j] / (BTIJ[i][j] * self.x[i] + self.x[j]);
                        f = 2.0;
                    }
                }
            }
        }
        if vr > EPSILON {
            dr = 1.0 / vr;
        }
        self.drold = dr;
        self.trold = tr;
        (dr, tr)
    }

    fn alpha0(&mut self) {
        let logt: f64;
        let logd: f64;
        let mut loghyp: f64;
        let mut th0t: f64;
        let mut logxd: f64;
        let mut sumhyp0: f64;
        let mut sumhyp1: f64;
        let mut sumhyp2: f64;
        let mut em: f64;
        let mut ep: f64;
        let mut hcn: f64;
        let mut hsn: f64;

        self.a0[0] = 0.0;
        self.a0[1] = 0.0;
        self.a0[2] = 0.0;
        if self.d > EPSILON {
            logd = f64::ln(self.d);
        } else {
            logd = f64::ln(EPSILON);
        }
        logt = f64::ln(self.t);
        for i in 1..=NC_GERG {
            if self.x[i] > EPSILON {
                logxd = logd + f64::ln(self.x[i]);
                sumhyp0 = 0.0;
                sumhyp1 = 0.0;
                sumhyp2 = 0.0;
                for j in 4..8 {
                    if TH0I[i][j] > EPSILON {
                        th0t = TH0I[i][j] / self.t;
                        ep = f64::exp(th0t);
                        em = 1.0 / ep;
                        hsn = (ep - em) / 2.0;
                        hcn = (ep + em) / 2.0;
                        if j == 4 || j == 6 {
                            loghyp = f64::ln(f64::abs(hsn));
                            sumhyp0 += N0I[i][j] * loghyp;
                            sumhyp1 += N0I[i][j] * th0t * hcn / hsn;
                            sumhyp2 += N0I[i][j] * (th0t / hsn) * (th0t / hsn);
                        } else {
                            loghyp = f64::ln(f64::abs(hcn));
                            sumhyp0 -= N0I[i][j] * loghyp;
                            sumhyp1 -= N0I[i][j] * th0t * hsn / hcn;
                            sumhyp2 += N0I[i][j] * (th0t / hcn) * (th0t / hcn);
                        }
                    }
                }
                self.a0[0] += self.x[i]
                    * (logxd + N0I[i][1] + N0I[i][2] / self.t - N0I[i][3] * logt + sumhyp0);
                self.a0[1] += self.x[i] * (N0I[i][3] + N0I[i][2] / self.t + sumhyp1);
                self.a0[2] += -self.x[i] * (N0I[i][3] + sumhyp2);
            }
        }
    }

    fn alphar(&mut self, itau: i32) {
        let mut ex: f64;
        let mut ex2: f64;
        let mut ex3: f64;
        let mut cij0: f64;
        let mut eij0: f64;
        let mut ndt: f64;
        let mut ndtd: f64;
        let mut ndtt: f64;
        let mut xijf: f64;
        let mut delp: [f64; 7 + 1] = [0.0; 7 + 1];
        let mut expd: [f64; 7 + 1] = [0.0; 7 + 1];

        for i in 0..4 {
            for j in 0..4 {
                self.ar[i][j] = 0.0;
            }
        }

        //Set up del, tau, log(tau), and the first 7 calculations for del^i
        let (dr, tr) = self.reducingparameters();
        let del = self.d / dr;
        let tau = tr / self.t;
        let lntau = f64::ln(tau);
        delp[1] = del;
        expd[1] = f64::exp(-delp[1]);
        for i in 2..8 {
            delp[i] = delp[i - 1] * del;
            expd[i] = f64::exp(-delp[i]);
        }

        // If temperature has changed, calculate temperature dependent parts
        if f64::abs(self.t - self.told) > 0.000_000_1 || f64::abs(tr - self.trold2) > 0.000_000_1 {
            self.tterms(lntau);
        }
        self.told = self.t;
        self.trold2 = tr;

        // Calculate pure fluid contributions
        for i in 1..=NC_GERG {
            if self.x[i] > EPSILON {
                for k in 1..=KPOL[i] {
                    ndt = self.x[i] * delp[DOIK[i][k]] * self.taup[i][k];
                    ndtd = ndt * DOIK[i][k] as f64;
                    self.ar[0][1] += ndtd;
                    self.ar[0][2] += ndtd * (DOIK[i][k] as f64 - 1.0);
                    if itau > 0 {
                        ndtt = ndt * TOIK[i][k];
                        self.ar[0][0] += ndt;
                        self.ar[1][0] += ndtt;
                        self.ar[2][0] += ndtt * (TOIK[i][k] - 1.0);
                        self.ar[1][1] += ndtt * DOIK[i][k] as f64;
                        self.ar[1][2] += ndtt * DOIK[i][k] as f64 * (DOIK[i][k] as f64 - 1.0);
                        self.ar[0][3] +=
                            ndtd * (DOIK[i][k] as f64 - 1.0) * (DOIK[i][k] as f64 - 2.0);
                    }
                }
                for k in 1 + KPOL[i]..=KPOL[i] + KEXP[i] {
                    ndt = self.x[i] * delp[DOIK[i][k]] * self.taup[i][k] * expd[COIK[i][k]];
                    ex = COIK[i][k] as f64 * delp[COIK[i][k]];
                    ex2 = DOIK[i][k] as f64 - ex;
                    ex3 = ex2 * (ex2 - 1.0);
                    self.ar[0][1] += ndt * ex2;
                    self.ar[0][2] += ndt * (ex3 - COIK[i][k] as f64 * ex);
                    if itau > 0 {
                        ndtt = ndt * TOIK[i][k];
                        self.ar[0][0] += ndt;
                        self.ar[1][0] += ndtt;
                        self.ar[2][0] += ndtt * (TOIK[i][k] - 1.0);
                        self.ar[1][1] += ndtt * ex2;
                        self.ar[1][2] += ndtt * (ex3 - COIK[i][k] as f64 * ex);
                        self.ar[0][3] += ndt
                            * (ex3 * (ex2 - 2.0)
                                - ex * (3.0 * ex2 - 3.0 + COIK[i][k] as f64) * COIK[i][k] as f64);
                    }
                }
            }
        }

        // Calculate mixture contributions
        for i in 1..=NC_GERG {
            if self.x[i] > EPSILON {
                for j in i + 1..=NC_GERG {
                    if self.x[j] > EPSILON {
                        let mn = MNUMB[i][j];
                        if mn > 0 {
                            xijf = self.x[i] * self.x[j] * FIJ[i][j];
                            for k in 1..=KPOLIJ[mn] {
                                ndt = xijf * delp[DIJK[mn][k]] * self.taupijk[mn][k];
                                ndtd = ndt * DIJK[mn][k] as f64;
                                self.ar[0][1] += ndtd;
                                self.ar[0][2] += ndtd * (DIJK[mn][k] as f64 - 1.0);
                                if itau > 0 {
                                    ndtt = ndt * TIJK[mn][k] as f64;
                                    self.ar[0][0] += ndt;
                                    self.ar[1][0] += ndtt;
                                    self.ar[2][0] += ndtt * (TIJK[mn][k] - 1.0);
                                    self.ar[1][1] += ndtt * DIJK[mn][k] as f64;
                                    self.ar[1][2] +=
                                        ndtt * DIJK[mn][k] as f64 * (DIJK[mn][k] as f64 - 1.0);
                                    self.ar[0][3] += ndtd
                                        * (DIJK[mn][k] as f64 - 1.0)
                                        * (DIJK[mn][k] as f64 - 2.0);
                                }
                            }
                            for k in 1 + KPOLIJ[mn]..=KPOLIJ[mn] + KEXPIJ[mn] {
                                cij0 = CIJK[mn][k] * delp[2];
                                eij0 = EIJK[mn][k] * del;
                                ndt = xijf
                                    * NIJK[mn][k]
                                    * delp[DIJK[mn][k]]
                                    * f64::exp(cij0 + eij0 + GIJK[mn][k] + TIJK[mn][k] * lntau);
                                ex = DIJK[mn][k] as f64 + 2.0 * cij0 + eij0;
                                ex2 = ex * ex - DIJK[mn][k] as f64 + 2.0 * cij0;
                                self.ar[0][1] += ndt * ex;
                                self.ar[0][2] += ndt * ex2;
                                if itau > 0 {
                                    ndtt = ndt * TIJK[mn][k];
                                    self.ar[0][0] += ndt;
                                    self.ar[1][0] += ndtt;
                                    self.ar[2][0] += ndtt * (TIJK[mn][k] - 1.0);
                                    self.ar[1][1] += ndtt * ex;
                                    self.ar[1][2] += ndtt * ex2;
                                    self.ar[0][3] += ndt
                                        * (ex * (ex2 - 2.0 * (DIJK[mn][k] as f64 - 2.0 * cij0))
                                            + 2.0 * DIJK[mn][k] as f64);
                                }
                            }
                        }
                    }
                }
            }
        }
    }

    fn tterms(&mut self, lntau: f64) {
        let i: usize = 5;
        let mut taup0: [f64; 12 + 1] = [0.0; 12 + 1];

        //i = 5;  // Use propane to get exponents for short form of EOS
        for k in 1..=KPOL[i] + KEXP[i] {
            taup0[k] = f64::exp(TOIK[i][k] * lntau);
        }
        for i in 1..=NC_GERG {
            if self.x[i] > EPSILON {
                if i > 4 && i != 15 && i != 18 && i != 20 {
                    for k in 0..KPOL[i] + KEXP[i] {
                        self.taup[i][k] = NOIK[i][k] * taup0[k];
                    }
                } else {
                    for k in 0..KPOL[i] + KEXP[i] {
                        self.taup[i][k] = NOIK[i][k] * f64::exp(TOIK[i][k] * lntau);
                    }
                }
            }
        }

        for i in 1..=NC_GERG {
            if self.x[i] > EPSILON {
                for j in i + 1..=NC_GERG {
                    if self.x[j] > EPSILON {
                        let mn = MNUMB[i][j];
                        if mn > 0 {
                            for k in 1..=KPOLIJ[mn] {
                                self.taupijk[mn][k] = NIJK[mn][k] * f64::exp(TIJK[mn][k] * lntau);
                            }
                        }
                    }
                }
            }
        }
    }

    fn pseudocriticalpoint(&mut self) -> (f64, f64) {
        let mut dcx = 0.0;
        let mut tcx = 0.0;
        let mut vcx: f64 = 0.0;

        for i in 1..=NC_GERG {
            tcx += self.x[i] * TC[i];
            vcx += self.x[i] / DC[i];
        }
        if vcx > EPSILON {
            dcx = 1.0 / vcx;
        }
        (dcx, tcx)
    }
}
